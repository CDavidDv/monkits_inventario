import{m as $,y as z,c as D,w as v,o,a as e,b as n,f as g,d as l,t as d,e as L,j as m,k as w,v as h,g as f,F as p,u as y,l as c,G as H}from"./app-BqIOlYv4.js";import{S as k}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{_ as I}from"./AppLayout-CMsQbeNk.js";import{C as N}from"./Container-BNq1TeXn.js";import{_ as x}from"./StatCard-BAAoyDfp.js";import{_ as R}from"./Badge-BSKt-TSl.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6"},P={key:0,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},q={class:"flex items-center"},G={class:"h-12 w-12 rounded-full bg-blue-500 flex items-center justify-center text-white text-lg font-bold mr-4"},J={class:"font-medium text-gray-900"},K={class:"text-sm text-gray-600"},Q={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},W={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},X=["value"],Y=["value"],Z=["value"],ee={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},te={class:"overflow-x-auto"},se={class:"w-full divide-y divide-gray-200"},re={class:"bg-white divide-y divide-gray-200"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},le={class:"px-6 py-4 whitespace-nowrap"},ae={class:"flex items-center"},ie={class:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-xs font-medium mr-3"},de={class:"text-sm font-medium text-gray-900"},ne={class:"px-6 py-4 whitespace-nowrap"},ue={class:"px-6 py-4 whitespace-nowrap"},me={class:"px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full"},ce={class:"px-6 py-4 text-sm text-gray-900 max-w-xs truncate"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},fe=["onClick"],pe={key:0},ye={class:"mt-6 flex items-center justify-between"},be={class:"flex-1 flex justify-between sm:hidden"},ve={key:1,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-400 bg-gray-50"},we={key:3,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-400 bg-gray-50"},he={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},ke={class:"text-sm text-gray-700"},Ce={class:"font-medium"},_e={class:"font-medium"},Ae={class:"font-medium"},Se={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px"},Ue={key:1,class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-gray-50 text-sm font-medium text-gray-300"},Be={key:3,class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-gray-50 text-sm font-medium text-gray-300"},ze={__name:"Index",props:{logs:Object,users:Array,actions:Array,modules:Array,filters:Object,stats:Object},setup(r){const u=r,i=$({search:u.filters.search||"",action:u.filters.action||"",module:u.filters.module||"",user_id:u.filters.user_id||"",date_from:u.filters.date_from||"",date_to:u.filters.date_to||""}),b=()=>{c.get(route("system-logs.index"),i,{preserveState:!0,preserveScroll:!0})},V=()=>{Object.keys(i).forEach(a=>i[a]=""),b()},j=async()=>{if((await k.fire({title:"¿Estás seguro?",text:"Se eliminarán todos los registros de más de 90 días. Esta acción no se puede deshacer.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Sí, limpiar",cancelButtonText:"Cancelar"})).isConfirmed)try{const t=await H.post(route("system-logs.cleanup"));k.fire("¡Éxito!",t.data.message,"success"),location.reload()}catch{k.fire("Error","Ocurrió un error al limpiar los registros","error")}},T=a=>{c.visit(route("system-logs.show",a.id))},E=a=>new Date(a).toLocaleString("es-ES",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),C=a=>({create:"Crear",update:"Actualizar",delete:"Eliminar",login:"Iniciar Sesión",logout:"Cerrar Sesión",view:"Ver",export:"Exportar",import:"Importar",restore:"Restaurar",force_delete:"Eliminar Permanentemente"})[a]||a.charAt(0).toUpperCase()+a.slice(1),_=a=>({user:"Usuario",item:"Item",category:"Categoría",supplier:"Proveedor",inventory:"Inventario",production:"Producción",auth:"Autenticación",system:"Sistema"})[a]||a.charAt(0).toUpperCase()+a.slice(1),F=a=>({create:"green",update:"blue",delete:"red",login:"green",logout:"gray",view:"blue",export:"purple",import:"indigo",restore:"yellow",force_delete:"red"})[a]||"gray";let A;return z(()=>i.search,()=>{clearTimeout(A),A=setTimeout(b,500)}),(a,t)=>(o(),D(I,{title:"Registro de Auditoría del Sistema"},{header:v(()=>t[10]||(t[10]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Registro de Auditoría del Sistema ",-1)])),default:v(()=>[n(N,null,{default:v(()=>{var S,U,B;return[e("div",{class:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6"},[e("div",{class:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Registro de Auditoría del Sistema"),e("p",{class:"text-sm text-gray-600 mt-1"},"Historial completo de actividades del sistema")],-1)),e("div",{class:"flex gap-3 mt-4 sm:mt-0"},[e("button",{onClick:j,class:"inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 text-white text-sm font-medium rounded-lg"},t[11]||(t[11]=[e("svg",{class:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1-1H9a1 1 0 00-1 1v3M4 7h16"})],-1),g(" Limpiar (90+ días) ")]))])])]),e("div",O,[n(x,{title:"Registros",label:"Total Registros",text:"Total de acciones registradas en el sistema",value:r.stats.total_logs,variant:"primary"},null,8,["value"]),n(x,{title:"Actividad",label:"Hoy",value:r.stats.logs_today,text:"Acciones registradas en las últimas 24 horas",variant:"success"},null,8,["value"]),n(x,{title:"Actividad",label:"Esta Semana",value:r.stats.logs_this_week,text:"Acciones registradas en los últimos 7 días",variant:"info"},null,8,["value"]),n(x,{title:"Actividad",label:"Este Mes",value:r.stats.logs_this_month,text:"Acciones registradas en los últimos 30 días",variant:"warning"},null,8,["value"]),n(x,{title:"Usuarios",label:"Usuarios Activos Hoy",value:r.stats.unique_users_today,text:"Número de usuarios únicos que han realizado acciones hoy",variant:"default"},null,8,["value"])]),r.stats.most_active_user?(o(),l("div",P,[t[13]||(t[13]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-3"},"Usuario Más Activo",-1)),e("div",q,[e("div",G,d(((U=(S=r.stats.most_active_user.user)==null?void 0:S.name)==null?void 0:U.charAt(0).toUpperCase())||"?"),1),e("div",null,[e("p",J,d(((B=r.stats.most_active_user.user)==null?void 0:B.name)||"Usuario desconocido"),1),e("p",K,d(r.stats.most_active_user.log_count)+" acciones registradas",1)])])])):L("",!0),e("div",Q,[e("div",W,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Buscar",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>i.search=s),type:"text",placeholder:"Buscar en logs...",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[w,i.search]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Acción",-1)),m(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>i.action=s),class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[t[15]||(t[15]=e("option",{value:""},"Todas las acciones",-1)),(o(!0),l(p,null,f(r.actions,s=>(o(),l("option",{key:s,value:s},d(C(s)),9,X))),128))],512),[[h,i.action]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Módulo",-1)),m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.module=s),class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[t[17]||(t[17]=e("option",{value:""},"Todos los módulos",-1)),(o(!0),l(p,null,f(r.modules,s=>(o(),l("option",{key:s,value:s},d(_(s)),9,Y))),128))],512),[[h,i.module]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Usuario",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>i.user_id=s),class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},[t[19]||(t[19]=e("option",{value:""},"Todos los usuarios",-1)),(o(!0),l(p,null,f(r.users,s=>(o(),l("option",{key:s.id,value:s.id},d(s.name),9,Z))),128))],512),[[h,i.user_id]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Desde",-1)),m(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>i.date_from=s),type:"date",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[w,i.date_from]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Fecha Hasta",-1)),m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>i.date_to=s),type:"date",class:"w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"},null,512),[[w,i.date_to]])]),e("div",{class:"flex items-end gap-2 col-span-2"},[e("button",{onClick:b,class:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg"}," Filtrar "),e("button",{onClick:V,class:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium rounded-lg"}," Limpiar ")])])]),e("div",ee,[e("div",te,[e("table",se,[t[24]||(t[24]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Usuario"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acción"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Módulo"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Descripción"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"IP"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones")])],-1)),e("tbody",re,[(o(!0),l(p,null,f(r.logs.data,s=>{var M;return o(),l("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",oe,d(E(s.created_at)),1),e("td",le,[e("div",ae,[e("div",ie,d(s.user?s.user.name.charAt(0).toUpperCase():"S"),1),e("span",de,d(((M=s.user)==null?void 0:M.name)||"Sistema"),1)])]),e("td",ne,[n(R,{color:F(s.action),text:C(s.action)},null,8,["color","text"])]),e("td",ue,[e("span",me,d(_(s.module)),1)]),e("td",ce,d(s.description),1),e("td",ge,d(s.ip_address),1),e("td",xe,[e("button",{onClick:Me=>T(s),class:"text-blue-600 hover:text-blue-900"}," Ver detalles ",8,fe)])])}),128)),r.logs.data.length===0?(o(),l("tr",pe,t[23]||(t[23]=[e("td",{colspan:"7",class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center"}," No se encontraron registros ",-1)]))):L("",!0)])])])]),e("div",ye,[e("div",be,[r.logs.prev_page_url?(o(),l("button",{key:0,onClick:t[6]||(t[6]=s=>y(c).visit(r.logs.prev_page_url)),class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Anterior ")):(o(),l("div",ve," Anterior ")),r.logs.next_page_url?(o(),l("button",{key:2,onClick:t[7]||(t[7]=s=>y(c).visit(r.logs.next_page_url)),class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"}," Siguiente ")):(o(),l("div",we," Siguiente "))]),e("div",he,[e("div",null,[e("p",ke,[t[25]||(t[25]=g(" Mostrando ")),e("span",Ce,d(r.logs.from||0),1),t[26]||(t[26]=g(" a ")),e("span",_e,d(r.logs.to||0),1),t[27]||(t[27]=g(" de ")),e("span",Ae,d(r.logs.total||0),1),t[28]||(t[28]=g(" resultados "))])]),e("div",null,[e("nav",Se,[r.logs.prev_page_url?(o(),l("button",{key:0,onClick:t[8]||(t[8]=s=>y(c).visit(r.logs.prev_page_url)),class:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"},t[29]||(t[29]=[e("svg",{class:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]))):(o(),l("div",Ue,t[30]||(t[30]=[e("svg",{class:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1)]))),r.logs.next_page_url?(o(),l("button",{key:2,onClick:t[9]||(t[9]=s=>y(c).visit(r.logs.next_page_url)),class:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50"},t[31]||(t[31]=[e("svg",{class:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)]))):(o(),l("div",Be,t[32]||(t[32]=[e("svg",{class:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1)])))])])])])]}),_:1})]),_:1}))}};export{ze as default};
