import{T as B,h as b,c as M,w as v,o as l,a as e,b as i,f as m,u as o,i as q,p as j,j as _,k as w,v as K,d as a,g as h,F as C,t as n,e as c,n as V}from"./app-Bbm6nPfF.js";import{_ as P}from"./AppLayout-BVLftzrV.js";import{C as U}from"./Container-s7YzfQE3.js";import{_ as p}from"./InputLabel-BnPyyqhe.js";import{_ as g}from"./TextInput-3LTJMV0m.js";import{_ as f}from"./InputError-BwEQXkyc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"flex justify-between items-center"},I={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},T={class:"p-6"},$={class:"space-y-6"},z=["value"],A={key:0,class:"bg-blue-50 p-4 rounded-lg"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},Q={class:"text-blue-900 ml-2"},R={class:"text-blue-900 ml-2"},G={key:0},H={class:"space-y-2"},J={class:"font-medium"},W={class:"text-sm text-gray-600 ml-2"},X={class:"text-sm"},Y={class:"text-gray-600"},Z={key:0,class:"text-sm text-gray-600 mt-1"},ee={key:1,class:"bg-gray-50 p-4 rounded-lg"},te={class:"space-y-2"},se={key:0},oe={key:2,class:"bg-red-50 border border-red-200 rounded-lg p-4"},de={class:"flex items-center justify-end mt-6 space-x-3"},ie=["disabled"],ne={key:0},re={key:1},ve={__name:"Create",props:{kits:Array},setup(x){const S=x,s=B({name:"",description:"",kit_id:"",quantity_requested:1,due_date:"",notes:""}),D=b(()=>{const r=new Date;return r.setDate(r.getDate()+1),r.toISOString().slice(0,16)}),u=b(()=>s.kit_id?S.kits.find(r=>r.id==s.kit_id):null),k=b(()=>!u.value||!u.value.assigned_items||s.quantity_requested<=0?!1:u.value.assigned_items.some(r=>{const t=r.quantity*s.quantity_requested;return r.item.current_stock<t})),N=()=>{s.quantity_requested<=0&&(s.quantity_requested=1)},L=(r,t)=>{const y=r.quantity*t;return r.item.current_stock>=y?"border-green-400":"border-red-400"},O=()=>{s.post(route("production.store"))};return(r,t)=>(l(),M(P,{title:"Nueva Orden de Producción"},{header:v(()=>[e("div",F,[t[7]||(t[7]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Nueva Orden de Producción ",-1)),i(o(q),{href:r.route("production.index"),class:"bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded inline-flex items-center"},{default:v(()=>t[6]||(t[6]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),m(" Volver ")])),_:1},8,["href"])])]),default:v(()=>[i(U,null,{default:v(()=>{var y;return[e("div",I,[e("div",T,[e("form",{onSubmit:j(O,["prevent"])},[e("div",$,[e("div",null,[i(p,{for:"name",value:"Nombre de la Orden *"}),i(g,{id:"name",modelValue:o(s).name,"onUpdate:modelValue":t[0]||(t[0]=d=>o(s).name=d),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",placeholder:"Ej: Producción de Kit Arduino Básico - Lote 001"},null,8,["modelValue"]),i(f,{class:"mt-2",message:o(s).errors.name},null,8,["message"])]),e("div",null,[i(p,{for:"description",value:"Descripción"}),_(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=d=>o(s).description=d),rows:"3",class:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Describe los detalles de esta orden de producción..."},null,512),[[w,o(s).description]]),i(f,{class:"mt-2",message:o(s).errors.description},null,8,["message"])]),e("div",null,[i(p,{for:"kit_id",value:"Kit a Producir *"}),_(e("select",{id:"kit_id","onUpdate:modelValue":t[2]||(t[2]=d=>o(s).kit_id=d),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",required:"",onChange:N},[t[8]||(t[8]=e("option",{value:""},"Seleccionar kit",-1)),(l(!0),a(C,null,h(x.kits,d=>(l(),a("option",{key:d.id,value:d.id},n(d.name)+" (Stock actual: "+n(d.current_stock)+") ",9,z))),128))],544),[[K,o(s).kit_id]]),i(f,{class:"mt-2",message:o(s).errors.kit_id},null,8,["message"])]),u.value?(l(),a("div",A,[t[13]||(t[13]=e("h4",{class:"text-lg font-medium text-blue-900 mb-2"},"Información del Kit",-1)),e("div",E,[e("div",null,[t[9]||(t[9]=e("span",{class:"font-medium text-blue-800"},"Nombre:",-1)),e("span",Q,n(u.value.name),1)]),e("div",null,[t[10]||(t[10]=e("span",{class:"font-medium text-blue-800"},"Stock actual:",-1)),e("span",R,n(u.value.current_stock)+" unidades",1)])]),u.value.assigned_items&&u.value.assigned_items.length>0?(l(),a("div",G,[t[12]||(t[12]=e("h5",{class:"font-medium text-blue-800 mb-2"},"Componentes necesarios por kit:",-1)),e("div",H,[(l(!0),a(C,null,h(u.value.assigned_items,d=>(l(),a("div",{key:d.id,class:V(["flex justify-between items-center bg-white p-2 rounded border-l-4",L(d,o(s).quantity_requested)])},[e("div",null,[e("span",J,n(d.item.name),1),e("span",W," ("+n(d.quantity)+" "+n(d.quantity===1?"unidad":"unidades")+" por kit) ",1)]),e("div",X,[t[11]||(t[11]=e("span",{class:"font-medium"},"Stock disponible:",-1)),e("span",{class:V(d.item.current_stock>=d.quantity*o(s).quantity_requested?"text-green-600":"text-red-600")},n(d.item.current_stock),3),e("span",Y," / "+n(d.quantity*o(s).quantity_requested)+" necesario ",1)])],2))),128))])])):c("",!0)])):c("",!0),e("div",null,[i(p,{for:"quantity_requested",value:"Cantidad a Producir *"}),i(g,{id:"quantity_requested",modelValue:o(s).quantity_requested,"onUpdate:modelValue":t[3]||(t[3]=d=>o(s).quantity_requested=d),modelModifiers:{number:!0},type:"number",min:"1",class:"mt-1 block w-full",required:"",placeholder:"Cantidad de kits a producir"},null,8,["modelValue"]),i(f,{class:"mt-2",message:o(s).errors.quantity_requested},null,8,["message"]),o(s).quantity_requested>0?(l(),a("div",Z," Se producirán "+n(o(s).quantity_requested)+" "+n(o(s).quantity_requested===1?"kit":"kits"),1)):c("",!0)]),e("div",null,[i(p,{for:"due_date",value:"Fecha Límite"}),i(g,{id:"due_date",modelValue:o(s).due_date,"onUpdate:modelValue":t[4]||(t[4]=d=>o(s).due_date=d),type:"datetime-local",class:"mt-1 block w-full",min:D.value},null,8,["modelValue","min"]),i(f,{class:"mt-2",message:o(s).errors.due_date},null,8,["message"]),t[14]||(t[14]=e("div",{class:"text-sm text-gray-600 mt-1"}," Opcional: Fecha y hora límite para completar la producción ",-1))]),e("div",null,[i(p,{for:"notes",value:"Notas Adicionales"}),_(e("textarea",{id:"notes","onUpdate:modelValue":t[5]||(t[5]=d=>o(s).notes=d),rows:"3",class:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Instrucciones especiales, consideraciones técnicas, etc."},null,512),[[w,o(s).notes]]),i(f,{class:"mt-2",message:o(s).errors.notes},null,8,["message"])]),o(s).name&&o(s).kit_id&&o(s).quantity_requested>0?(l(),a("div",ee,[t[19]||(t[19]=e("h4",{class:"text-lg font-medium text-gray-900 mb-2"},"Resumen de la Orden",-1)),e("div",te,[e("div",null,[t[15]||(t[15]=e("span",{class:"font-medium"},"Orden:",-1)),m(" "+n(o(s).name),1)]),e("div",null,[t[16]||(t[16]=e("span",{class:"font-medium"},"Kit:",-1)),m(" "+n((y=u.value)==null?void 0:y.name),1)]),e("div",null,[t[17]||(t[17]=e("span",{class:"font-medium"},"Cantidad:",-1)),m(" "+n(o(s).quantity_requested)+" "+n(o(s).quantity_requested===1?"kit":"kits"),1)]),o(s).due_date?(l(),a("div",se,[t[18]||(t[18]=e("span",{class:"font-medium"},"Fecha límite:",-1)),m(" "+n(new Date(o(s).due_date).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})),1)])):c("",!0)])])):c("",!0),k.value?(l(),a("div",oe,t[20]||(t[20]=[e("div",{class:"flex"},[e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])]),e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-medium text-red-800"},"Stock Insuficiente"),e("div",{class:"mt-2 text-sm text-red-700"},[e("p",null,"No hay suficientes componentes en stock para completar esta producción. Verifica el inventario antes de continuar.")])])],-1)]))):c("",!0)]),e("div",de,[i(o(q),{href:r.route("production.index"),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded"},{default:v(()=>t[21]||(t[21]=[m(" Cancelar ")])),_:1},8,["href"]),e("button",{type:"submit",disabled:o(s).processing||k.value,class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50"},[o(s).processing?(l(),a("span",ne,"Creando...")):(l(),a("span",re,"Crear Orden de Producción"))],8,ie)])],32)])])]}),_:1})]),_:1}))}};export{ve as default};
