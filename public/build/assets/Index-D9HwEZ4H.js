import{m as O,r as E,h as V,l as F,c as k,w as u,o as l,a as e,u as m,i as y,f as c,e as x,t as r,j as _,k as R,v as N,d,g as P,F as M,b as w,n as A}from"./app-DwDI59q_.js";import{_ as X}from"./AppLayout-CCrStt77.js";import{_ as W}from"./ConfirmationModal-DXomKtL5.js";import{_ as J}from"./SecondaryButton-CQXy8ZPl.js";import{_ as K}from"./DangerButton-Db_BxwC7.js";import{l as Q}from"./lodash-Ds6t0wwt.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Modal-4-sqCmCI.js";const Y={class:"flex justify-between items-center"},Z={class:"flex space-x-2"},ee={class:"py-12"},te={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},se={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},oe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},re={class:"flex items-center"},le={class:"ml-4"},ie={class:"text-2xl font-bold text-gray-900"},ne={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},de={class:"flex items-center"},ae={class:"ml-4"},ue={class:"text-2xl font-bold text-green-600"},ce={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},me={class:"flex items-center"},xe={class:"ml-4"},pe={class:"text-2xl font-bold text-purple-600"},fe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg p-6"},ge={class:"flex items-center"},ve={class:"ml-4"},he={class:"text-2xl font-bold text-orange-600"},ye={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg mb-6"},we={class:"p-6"},be={class:"grid grid-cols-1 md:grid-cols-5 gap-4"},ke=["value"],_e=["value"],Pe={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},Me={class:"p-6"},Ce={class:"overflow-x-auto"},Se={class:"min-w-full divide-y divide-gray-200"},$e={class:"bg-gray-50"},je={key:0,class:"ml-1"},Ee={key:0,class:"ml-1"},Ve={key:0,class:"ml-1"},Fe={class:"bg-white divide-y divide-gray-200"},Ne={class:"px-6 py-4 whitespace-nowrap"},Ae={class:"flex items-center"},Be={class:"text-sm font-medium text-gray-900"},Te={class:"text-sm text-gray-500"},Ue={class:"px-6 py-4 whitespace-nowrap"},ze={class:"flex items-center"},De={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-xs mr-3"},Ie={class:"text-sm font-medium text-gray-900"},He={class:"text-sm text-gray-500"},qe={class:"px-6 py-4 whitespace-nowrap"},Le={class:"text-sm font-medium text-green-600"},Ge={class:"px-6 py-4 whitespace-nowrap"},Oe={class:"text-sm font-medium text-blue-600"},Re={class:"px-6 py-4 whitespace-nowrap"},Xe={key:0},We={class:"text-xs text-gray-500"},Je={key:1,class:"text-sm text-gray-400"},Ke={class:"px-6 py-4 whitespace-nowrap"},Qe={class:"text-sm text-gray-900"},Ye={class:"px-6 py-4 whitespace-nowrap"},Ze={key:0,class:"text-sm font-medium text-purple-600"},et={key:1,class:"text-sm text-gray-400"},tt={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},st={class:"flex space-x-2"},ot=["onClick"],rt={key:0,class:"mt-6"},lt={class:"flex justify-between items-center"},it={class:"text-sm text-gray-700"},nt={class:"flex space-x-1"},gt={__name:"Index",props:{elementPrices:Object,suppliers:Array,categories:Array,filters:Object},setup(i){const a=i,n=O({search:a.filters.search||"",supplier_id:a.filters.supplier_id||"",category:a.filters.category||"",currency:a.filters.currency||""}),f=E(!1),p=E(null),C=E(!1),T=V(()=>{if(!a.elementPrices.data||a.elementPrices.data.length===0)return 0;const o=a.elementPrices.data.filter(t=>t.purchase_price&&t.selling_price).map(t=>$(t));return o.length===0?0:o.reduce((t,b)=>t+b,0)/o.length}),U=V(()=>a.elementPrices.data?new Set(a.elementPrices.data.map(t=>t.supplier.id)).size:0),z=V(()=>a.elementPrices.data?new Set(a.elementPrices.data.map(t=>t.element.id)).size:0),B=Q.debounce(()=>{g()},500),g=()=>{F.get(route("element-prices.index"),{search:n.search,supplier_id:n.supplier_id,category:n.category,currency:n.currency,sort:a.filters.sort,direction:a.filters.direction},{preserveState:!0,replace:!0})},S=o=>{const t=a.filters.sort===o&&a.filters.direction==="asc"?"desc":"asc";F.get(route("element-prices.index"),{...n,sort:o,direction:t},{preserveState:!0,replace:!0})},D=()=>{n.search="",n.supplier_id="",n.category="",n.currency="",g()},$=o=>!o.purchase_price||!o.selling_price?0:(o.selling_price-o.purchase_price)/o.purchase_price*100,I=o=>o>=30?"text-green-600":o>=15?"text-blue-600":o>=5?"text-yellow-600":"text-red-600",H=o=>o.current_stock<=0?"Agotado":o.current_stock<=o.min_stock?"Stock Bajo":"Normal",q=o=>o.current_stock<=0?"text-red-600":o.current_stock<=o.min_stock?"text-yellow-600":"text-green-600",L=o=>{p.value=o,f.value=!0},G=()=>{p.value&&(C.value=!0,F.delete(route("element-prices.destroy",p.value.id),{onSuccess:()=>{f.value=!1,p.value=null},onFinish:()=>{C.value=!1}}))};return(o,t)=>(l(),k(X,{title:"Gestión de Precios"},{header:u(()=>[e("div",Y,[t[11]||(t[11]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Gestión de Precios de Elementos ",-1)),e("div",Z,[o.$page.props.auth.user.permissions.includes("create prices")?(l(),k(m(y),{key:0,href:o.route("element-prices.create"),class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded inline-flex items-center"},{default:u(()=>t[10]||(t[10]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),c(" Nuevo Precio ")])),_:1},8,["href"])):x("",!0)])])]),default:u(()=>{var b;return[e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[e("div",re,[t[13]||(t[13]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})])])],-1)),e("div",le,[t[12]||(t[12]=e("div",{class:"text-sm font-medium text-gray-500"},"Total Precios",-1)),e("div",ie,r(i.elementPrices.total||((b=i.elementPrices.data)==null?void 0:b.length)||0),1)])])]),e("div",ne,[e("div",de,[t[15]||(t[15]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])])],-1)),e("div",ae,[t[14]||(t[14]=e("div",{class:"text-sm font-medium text-gray-500"},"Margen Promedio",-1)),e("div",ue,r(T.value.toFixed(1))+"%",1)])])]),e("div",ce,[e("div",me,[t[17]||(t[17]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})])])],-1)),e("div",xe,[t[16]||(t[16]=e("div",{class:"text-sm font-medium text-gray-500"},"Proveedores Únicos",-1)),e("div",pe,r(U.value),1)])])]),e("div",fe,[e("div",ge,[t[19]||(t[19]=e("div",{class:"flex-shrink-0"},[e("div",{class:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center"},[e("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"})])])],-1)),e("div",ve,[t[18]||(t[18]=e("div",{class:"text-sm font-medium text-gray-500"},"Elementos Únicos",-1)),e("div",he,r(z.value),1)])])])]),e("div",ye,[e("div",we,[e("div",be,[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Buscar",-1)),_(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>n.search=s),type:"text",placeholder:"Elemento o proveedor...",class:"mt-1 focus:ring-blue-500 focus:border-blue-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",onInput:t[1]||(t[1]=(...s)=>m(B)&&m(B)(...s))},null,544),[[R,n.search]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Proveedor",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.supplier_id=s),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",onChange:g},[t[21]||(t[21]=e("option",{value:""},"Todos los proveedores",-1)),(l(!0),d(M,null,P(i.suppliers,s=>(l(),d("option",{key:s.id,value:s.id},r(s.name),9,ke))),128))],544),[[N,n.supplier_id]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Categoría",-1)),_(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.category=s),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",onChange:g},[t[23]||(t[23]=e("option",{value:""},"Todas las categorías",-1)),(l(!0),d(M,null,P(i.categories,s=>(l(),d("option",{key:s,value:s},r(s),9,_e))),128))],544),[[N,n.category]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Moneda",-1)),_(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>n.currency=s),class:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",onChange:g},t[25]||(t[25]=[e("option",{value:""},"Todas las monedas",-1),e("option",{value:"MXN"},"MXN",-1),e("option",{value:"USD"},"USD",-1),e("option",{value:"EUR"},"EUR",-1)]),544),[[N,n.currency]])]),e("div",{class:"flex items-end"},[e("button",{onClick:D,class:"w-full bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded"}," Limpiar Filtros ")])])])]),e("div",Pe,[e("div",Me,[e("div",Ce,[e("table",Se,[e("thead",$e,[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:t[5]||(t[5]=s=>S("element_name"))},[t[27]||(t[27]=c(" Elemento ")),i.filters.sort==="element_name"?(l(),d("span",je,r(i.filters.direction==="asc"?"↑":"↓"),1)):x("",!0)]),t[30]||(t[30]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Proveedor ",-1)),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:t[6]||(t[6]=s=>S("purchase_price"))},[t[28]||(t[28]=c(" Precio Compra ")),i.filters.sort==="purchase_price"?(l(),d("span",Ee,r(i.filters.direction==="asc"?"↑":"↓"),1)):x("",!0)]),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:t[7]||(t[7]=s=>S("selling_price"))},[t[29]||(t[29]=c(" Precio Venta ")),i.filters.sort==="selling_price"?(l(),d("span",Ve,r(i.filters.direction==="asc"?"↑":"↓"),1)):x("",!0)]),t[31]||(t[31]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Margen ",-1)),t[32]||(t[32]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Stock Actual ",-1)),t[33]||(t[33]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Valor Stock ",-1)),t[34]||(t[34]=e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Acciones ",-1))])]),e("tbody",Fe,[(l(!0),d(M,null,P(i.elementPrices.data,s=>{var v,h;return l(),d("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",Ne,[e("div",Ae,[e("div",null,[e("div",Be,[w(m(y),{href:o.route("elements.show",s.element.id),class:"text-blue-600 hover:text-blue-800"},{default:u(()=>[c(r(s.element.name),1)]),_:2},1032,["href"])]),e("div",Te,r(s.element.category),1)])])]),e("td",Ue,[e("div",ze,[e("div",De,r(s.supplier.name.charAt(0).toUpperCase()),1),e("div",null,[e("div",Ie,[w(m(y),{href:o.route("suppliers.show",s.supplier.id),class:"text-blue-600 hover:text-blue-800"},{default:u(()=>[c(r(s.supplier.name),1)]),_:2},1032,["href"])]),e("div",He,r(s.supplier.country),1)])])]),e("td",qe,[e("div",Le,r(s.currency)+" $"+r(((v=s.purchase_price)==null?void 0:v.toFixed(2))||"N/A"),1)]),e("td",Ge,[e("div",Oe,r(s.currency)+" $"+r(((h=s.selling_price)==null?void 0:h.toFixed(2))||"N/A"),1)]),e("td",Re,[s.purchase_price&&s.selling_price?(l(),d("div",Xe,[e("div",{class:A(["text-sm font-medium",I($(s))])},r($(s).toFixed(1))+"% ",3),e("div",We," $"+r((s.selling_price-s.purchase_price).toFixed(2)),1)])):(l(),d("div",Je,"N/A"))]),e("td",Ke,[e("div",Qe,r(s.element.current_stock)+" "+r(s.element.unit),1),e("div",{class:A(["text-sm",q(s.element)])},r(H(s.element)),3)]),e("td",Ye,[s.purchase_price?(l(),d("div",Ze," $"+r((s.element.current_stock*s.purchase_price).toFixed(2)),1)):(l(),d("div",et,"N/A"))]),e("td",tt,[e("div",st,[o.$page.props.auth.user.permissions.includes("edit prices")?(l(),k(m(y),{key:0,href:o.route("element-prices.edit",s.id),class:"text-indigo-600 hover:text-indigo-900"},{default:u(()=>t[35]||(t[35]=[c(" Editar ")])),_:2},1032,["href"])):x("",!0),o.$page.props.auth.user.permissions.includes("delete prices")?(l(),d("button",{key:1,onClick:j=>L(s),class:"text-red-600 hover:text-red-900"}," Eliminar ",8,ot)):x("",!0)])])])}),128))])])]),i.elementPrices.links?(l(),d("div",rt,[e("div",lt,[e("div",it," Mostrando "+r(i.elementPrices.from)+" a "+r(i.elementPrices.to)+" de "+r(i.elementPrices.total)+" precios ",1),e("div",nt,[(l(!0),d(M,null,P(i.elementPrices.links,s=>(l(),k(m(y),{key:s.label,href:s.url,class:A(["px-3 py-2 text-sm rounded-md",s.active?"bg-blue-500 text-white":s.url?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 cursor-not-allowed"]),innerHTML:s.label},null,8,["href","class","innerHTML"]))),128))])])])):x("",!0)])])])]),w(W,{show:f.value,onClose:t[9]||(t[9]=s=>f.value=!1)},{title:u(()=>t[36]||(t[36]=[c(" Eliminar Precio ")])),content:u(()=>{var s,v,h,j;return[c(' ¿Estás seguro de que quieres eliminar el precio de "'+r((v=(s=p.value)==null?void 0:s.element)==null?void 0:v.name)+'" del proveedor "'+r((j=(h=p.value)==null?void 0:h.supplier)==null?void 0:j.name)+'"? Esta acción no se puede deshacer. ',1)]}),footer:u(()=>[w(J,{onClick:t[8]||(t[8]=s=>f.value=!1)},{default:u(()=>t[37]||(t[37]=[c(" Cancelar ")])),_:1}),w(K,{class:"ml-3",onClick:G,disabled:C.value},{default:u(()=>t[38]||(t[38]=[c(" Eliminar ")])),_:1},8,["disabled"])]),_:1},8,["show"])]}),_:1}))}};export{gt as default};
