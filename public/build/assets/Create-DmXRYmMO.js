import{r as H,T as N,h as k,q as A,c as K,w as p,o as r,a as e,b as d,f as g,u as l,i as S,p as U,j as v,k as w,v as C,d as a,F as V,g as q,t as u,n as x,e as m}from"./app-BqIOlYv4.js";import{_ as z}from"./AppLayout-CMsQbeNk.js";import{_}from"./InputLabel-CVdwMLDr.js";import{_ as I}from"./TextInput-CutBnAWr.js";import{_ as f}from"./InputError-vfZy364d.js";import{_ as R}from"./PrimaryButton-D1208OA8.js";import{_ as T}from"./SecondaryButton-BZf2RQZ7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"flex justify-between items-center"},L={class:"py-12"},O={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},Q={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},P={class:"p-6"},G={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"},J={class:"md:col-span-2"},W={class:"md:col-span-2"},X={class:"mb-8"},Y={key:0,class:"text-center py-8 text-gray-500"},Z={key:1,class:"space-y-3"},ee={class:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-4"},te={class:"md:col-span-2"},se=["onUpdate:modelValue","onChange"],oe=["value"],ne={key:0,class:"mt-1 text-sm text-gray-500"},le=["onUpdate:modelValue"],ie={key:0,class:"mt-1 text-xs text-gray-500"},re={key:0,class:"text-right"},ae={class:"text-sm"},de={class:"text-xs text-gray-500"},ue=["onClick"],ce={key:0,class:"mb-8 p-4 bg-blue-50 rounded-lg"},me={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},pe={class:"text-lg font-bold text-blue-900"},ge={class:"text-lg font-bold text-blue-900"},ve={key:0,class:"mt-3 text-sm text-red-600"},fe={class:"flex items-center justify-end space-x-3"},ye={key:0,class:"animate-spin -ml-1 mr-3 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},qe={__name:"Create",props:{elements:Array},setup(M){const h=M,y=H(h.elements||[]),s=N({name:"",description:"",category:"",components:[]}),b=k(()=>s.components.every(n=>n.element&&n.quantity<=n.element.current_stock)),$=k(()=>s.components.reduce((n,t)=>{if(t.element&&t.element.prices&&t.element.prices.length>0){const o=t.element.prices.reduce((c,i)=>c+(i.purchase_price||0),0)/t.element.prices.length;return n+o*t.quantity}return n},0)),B=()=>{s.components.push({element_id:"",quantity:1,element:null})},E=n=>{s.components.splice(n,1)},j=n=>{const t=s.components[n].element_id,o=y.value.find(c=>c.id==t);s.components[n].element=o},D=()=>{const n={name:s.name,description:s.description,category:s.category,components:s.components.map(t=>({element_id:t.element_id,quantity:t.quantity}))};s.transform(t=>n).post(route("inventory-kits.store"),{onSuccess:()=>{}})};return A(()=>{h.elements||fetch("/api/inventory/elements/search").then(n=>n.json()).then(n=>{y.value=n}).catch(n=>{console.error("Error al cargar elementos:",n)})}),(n,t)=>(r(),K(z,{title:"Crear Kit"},{header:p(()=>[e("div",F,[t[5]||(t[5]=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Crear Nuevo Kit de Inventario ",-1)),d(l(S),{href:n.route("inventory-kits.index"),class:"text-blue-600 hover:text-blue-800"},{default:p(()=>t[4]||(t[4]=[g(" ← Volver a la lista ")])),_:1},8,["href"])])]),default:p(()=>[e("div",L,[e("div",O,[e("div",Q,[e("div",P,[e("form",{onSubmit:U(D,["prevent"])},[e("div",G,[e("div",J,[d(_,{for:"name",value:"Nombre del Kit *"}),d(I,{id:"name",modelValue:l(s).name,"onUpdate:modelValue":t[0]||(t[0]=o=>l(s).name=o),type:"text",class:"mt-1 block w-full",required:"",autofocus:"",placeholder:"Ej: Kit de Resistencias Básicas"},null,8,["modelValue"]),d(f,{class:"mt-2",message:l(s).errors.name},null,8,["message"])]),e("div",W,[d(_,{for:"description",value:"Descripción"}),v(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=o=>l(s).description=o),rows:"3",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Descripción detallada del kit..."},null,512),[[w,l(s).description]]),d(f,{class:"mt-2",message:l(s).errors.description},null,8,["message"])]),e("div",null,[d(_,{for:"category",value:"Categoría"}),v(e("select",{id:"category","onUpdate:modelValue":t[2]||(t[2]=o=>l(s).category=o),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},t[6]||(t[6]=[e("option",{value:""},"Seleccionar categoría",-1),e("option",{value:"Electrónicos"},"Electrónicos",-1),e("option",{value:"Mecánicos"},"Mecánicos",-1),e("option",{value:"Químicos"},"Químicos",-1),e("option",{value:"Herramientas"},"Herramientas",-1),e("option",{value:"Educativo"},"Educativo",-1),e("option",{value:"Reparación"},"Reparación",-1),e("option",{value:"Otros"},"Otros",-1)]),512),[[C,l(s).category]]),d(f,{class:"mt-2",message:l(s).errors.category},null,8,["message"])])]),e("div",X,[e("div",{class:"flex justify-between items-center mb-4"},[t[8]||(t[8]=e("h3",{class:"text-lg font-medium text-gray-900"},"Componentes del Kit",-1)),e("button",{type:"button",onClick:B,class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded inline-flex items-center"},t[7]||(t[7]=[e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),g(" Agregar Componente ")]))]),l(s).components.length===0?(r(),a("div",Y,t[9]||(t[9]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1),e("p",null,"No hay componentes agregados al kit",-1),e("p",{class:"text-sm"},'Haz clic en "Agregar Componente" para empezar',-1)]))):(r(),a("div",Z,[(r(!0),a(V,null,q(l(s).components,(o,c)=>(r(),a("div",{key:c,class:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg"},[e("div",ee,[e("div",te,[v(e("select",{"onUpdate:modelValue":i=>o.element_id=i,onChange:i=>j(c),class:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",required:""},[t[10]||(t[10]=e("option",{value:""},"Seleccionar elemento",-1)),(r(!0),a(V,null,q(y.value,i=>(r(),a("option",{key:i.id,value:i.id},u(i.name)+" ("+u(i.current_stock)+" "+u(i.unit)+" disponibles) ",9,oe))),128))],40,se),[[C,o.element_id]]),o.element?(r(),a("div",ne,u(o.element.category)+" - "+u(o.element.description),1)):m("",!0)]),e("div",null,[v(e("input",{"onUpdate:modelValue":i=>o.quantity=i,type:"number",min:"1",class:"w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",placeholder:"Cantidad",required:""},null,8,le),[[w,o.quantity,void 0,{number:!0}]]),o.element?(r(),a("div",ie,u(o.element.unit),1)):m("",!0)])]),o.element?(r(),a("div",re,[e("div",ae,[e("span",{class:x([o.quantity<=o.element.current_stock?"text-green-600":"text-red-600","font-medium"])},u(o.quantity<=o.element.current_stock?"✓ Disponible":"✗ Insuficiente"),3)]),e("div",de," Stock: "+u(o.element.current_stock),1)])):m("",!0),e("button",{type:"button",onClick:i=>E(c),class:"text-red-600 hover:text-red-800"},t[11]||(t[11]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ue)]))),128))])),d(f,{class:"mt-2",message:l(s).errors.components},null,8,["message"])]),l(s).components.length>0?(r(),a("div",ce,[t[15]||(t[15]=e("h4",{class:"font-medium text-blue-900 mb-3"},"Resumen del Kit",-1)),e("div",me,[e("div",null,[t[12]||(t[12]=e("span",{class:"text-blue-700 font-medium"},"Total Componentes:",-1)),e("div",pe,u(l(s).components.length),1)]),e("div",null,[t[13]||(t[13]=e("span",{class:"text-blue-700 font-medium"},"Disponibilidad:",-1)),e("div",{class:x(["text-lg font-bold",b.value?"text-green-600":"text-red-600"])},u(b.value?"Disponible":"No Disponible"),3)]),e("div",null,[t[14]||(t[14]=e("span",{class:"text-blue-700 font-medium"},"Costo Estimado:",-1)),e("div",ge," $"+u($.value.toFixed(2)),1)])]),b.value?m("",!0):(r(),a("div",ve," ⚠️ Algunos componentes no tienen stock suficiente "))])):m("",!0),e("div",fe,[d(T,{type:"button",onClick:t[3]||(t[3]=o=>n.$inertia.visit(n.route("inventory-kits.index")))},{default:p(()=>t[16]||(t[16]=[g(" Cancelar ")])),_:1}),d(R,{class:x({"opacity-25":l(s).processing}),disabled:l(s).processing||l(s).components.length===0},{default:p(()=>[l(s).processing?(r(),a("svg",ye,t[17]||(t[17]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):m("",!0),t[18]||(t[18]=g(" Crear Kit "))]),_:1},8,["class","disabled"])])],32)])])])])]),_:1}))}};export{qe as default};
